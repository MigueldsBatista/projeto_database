<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Produto - Hospital Santa Joana</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .product-image-large {
            width: 100%;
            height: 240px;
            overflow: hidden;
            margin-bottom: var(--spacing-md);
        }
        
        .product-image-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-details-card {
            background-color: white;
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .product-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
        }
        
        .product-price-large {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: var(--spacing-md);
        }
        
        .product-description-full {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
            line-height: 1.6;
        }
        
        .product-info-section {
            margin-bottom: var(--spacing-md);
        }
        
        .product-info-title {
            font-size: var(--font-h2);
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
        }
        
        .info-list {
            list-style: none;
            padding: 0;
        }
        
        .info-list li {
            display: flex;
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--border);
        }
        
        .info-list li:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .info-label {
            width: 120px;
            color: var(--text-secondary);
        }
        
        .info-value {
            flex: 1;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }
        
        .quantity-label {
            margin-right: var(--spacing-md);
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="screen active" id="product-details-screen">
            <header class="app-header">
                <div class="header-left">
                    <button class="back-button" onclick="window.location.href='menu.html'">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h2>Detalhes do Produto</h2>
                </div>
            </header>

            <div class="content-area">
                <div class="product-image-large">
                    <img id="product-image" src="img/products/placeholder.jpg" alt="Produto">
                </div>
                
                <div class="product-details-card">
                    <h1 class="product-name" id="product-name">Nome do Produto</h1>
                    <p class="product-price-large">R$ <span id="product-price">0,00</span></p>
                    <p class="product-description-full" id="product-description">Descrição detalhada do produto...</p>
                    
                    <div class="quantity-control">
                        <span class="quantity-label">Quantidade:</span>
                        <button class="quantity-button" id="decrease-quantity">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="quantity-value" id="quantity-value">1</span>
                        <button class="quantity-button" id="increase-quantity">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <button class="btn-primary" id="add-to-cart-btn">
                        <i class="fas fa-shopping-cart"></i> Adicionar ao Carrinho
                    </button>
                </div>
                
                <div class="product-details-card" id="nutritional-info-section" style="display: none;">
                    <div class="product-info-section">
                        <h3 class="product-info-title">Informações Nutricionais</h3>
                        <ul class="info-list" id="nutritional-info-list">
                            <!-- Nutritional info will be added dynamically -->
                        </ul>
                    </div>
                </div>
                
                <div class="product-details-card">
                    <div class="product-info-section">
                        <h3 class="product-info-title">Informações Adicionais</h3>
                        <ul class="info-list">
                            <li>
                                <span class="info-label">Categoria:</span>
                                <span class="info-value" id="product-category">Categoria</span>
                            </li>
                            <li>
                                <span class="info-label">Tempo de preparo:</span>
                                <span class="info-value" id="prep-time">30 minutos</span>
                            </li>
                            <li>
                                <span class="info-label">Disponibilidade:</span>
                                <span class="info-value" id="availability">Em estoque</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <nav class="bottom-nav">
                <a href="dashboard.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>Início</span>
                </a>
                <a href="menu.html" class="nav-item active">
                    <i class="fas fa-utensils"></i>
                    <span>Cardápio</span>
                </a>
                <a href="cart.html" class="nav-item">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Carrinho</span>
                    <span class="badge cart-badge">0</span>
                </a>
                <a href="orders.html" class="nav-item">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Pedidos</span>
                </a>
                <a href="invoice.html" class="nav-item">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Fatura</span>
                </a>
            </nav>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get product ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('id'));
            
            if (!productId) {
                // No product ID provided, redirect to menu page
                window.location.href = 'menu.html';
                return;
            }
            
            // Get cart count from localStorage
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            updateCartBadge(cart.reduce((total, item) => total + item.quantity, 0));
            
            // Get product data from localStorage
            const menuItems = JSON.parse(localStorage.getItem('menuItems')) || [];
            const product = menuItems.find(item => item.id === productId);
            
            if (!product) {
                // Product not found, redirect to menu page
                window.location.href = 'menu.html';
                return;
            }
            
            // Update product details in the UI
            document.getElementById('product-name').textContent = product.name;
            document.getElementById('product-price').textContent = formatCurrency(product.price);
            document.getElementById('product-description').textContent = product.description;
            document.getElementById('product-image').src = product.image;
            document.getElementById('product-image').alt = product.name;
            
            // Set category name
            let categoryName = 'Geral';
            switch(product.category) {
                case 'breakfast':
                    categoryName = 'Café da Manhã';
                    break;
                case 'lunch':
                    categoryName = 'Almoço';
                    break;
                case 'dinner':
                    categoryName = 'Jantar';
                    break;
                case 'dessert':
                    categoryName = 'Sobremesa';
                    break;
            }
            document.getElementById('product-category').textContent = categoryName;
            
            // Set estimated prep time based on category
            let prepTime = '30 minutos';
            if (product.category === 'breakfast') {
                prepTime = '15 minutos';
            } else if (product.category === 'dessert') {
                prepTime = '10 minutos';
            }
            document.getElementById('prep-time').textContent = prepTime;
            
            // Add nutritional info for food items
            if (['breakfast', 'lunch', 'dinner', 'dessert'].includes(product.category)) {
                document.getElementById('nutritional-info-section').style.display = 'block';
                const nutritionalInfoList = document.getElementById('nutritional-info-list');
                
                // Generate some sample nutritional info
                const nutritionalInfo = [
                    { label: 'Calorias', value: `${Math.floor(Math.random() * 500 + 100)} kcal` },
                    { label: 'Proteínas', value: `${Math.floor(Math.random() * 20 + 5)}g` },
                    { label: 'Carboidratos', value: `${Math.floor(Math.random() * 50 + 10)}g` },
                    { label: 'Gorduras', value: `${Math.floor(Math.random() * 20 + 2)}g` },
                    { label: 'Sódio', value: `${Math.floor(Math.random() * 500 + 50)}mg` }
                ];
                
                nutritionalInfo.forEach(info => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `
                        <span class="info-label">${info.label}:</span>
                        <span class="info-value">${info.value}</span>
                    `;
                    nutritionalInfoList.appendChild(listItem);
                });
            }
            
            // Quantity control
            let quantity = 1;
            const quantityValue = document.getElementById('quantity-value');
            
            document.getElementById('decrease-quantity').addEventListener('click', function() {
                if (quantity > 1) {
                    quantity--;
                    quantityValue.textContent = quantity;
                }
            });
            
            document.getElementById('increase-quantity').addEventListener('click', function() {
                quantity++;
                quantityValue.textContent = quantity;
            });
            
            // Add to cart button
            document.getElementById('add-to-cart-btn').addEventListener('click', function() {
                // Get current cart
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                
                // Check if product already exists in cart
                const existingItem = cart.find(item => item.id === product.id);
                
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        image: product.image,
                        quantity: quantity
                    });
                }
                
                // Save updated cart
                localStorage.setItem('cart', JSON.stringify(cart));
                
                // Update cart badge
                updateCartBadge(cart.reduce((total, item) => total + item.quantity, 0));
                
                // Show success message
                showToast(`${quantity}x ${product.name} adicionado ao carrinho`, 'success');
                
                // Reset quantity
                quantity = 1;
                quantityValue.textContent = quantity;
            });
            
            function formatCurrency(value) {
                return value.toFixed(2).replace('.', ',');
            }
            
            function updateCartBadge(count) {
                const badges = document.querySelectorAll('.cart-badge');
                
                badges.forEach(badge => {
                    badge.textContent = count;
                    badge.style.display = count > 0 ? 'flex' : 'none';
                });
            }
            
            function showToast(message, type = 'default', duration = 3000) {
                // Remove any existing toasts
                const existingToast = document.querySelector('.toast');
                if (existingToast) {
                    existingToast.remove();
                }
                
                // Create new toast
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                
                document.body.appendChild(toast);
                
                // Show the toast
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);
                
                // Hide and remove the toast after duration
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        toast.remove();
                    }, 300);
                }, duration);
            }
        });
    </script>
</body>
</html>
